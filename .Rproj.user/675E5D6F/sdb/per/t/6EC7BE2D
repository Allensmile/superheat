{
    "collab_server" : "",
    "contents" : "library(maxent)\ndata(NYTimes)\n\n\nlibrary(superheat)\nlibrary(cluster)\nlibrary(RColorBrewer)\nlibrary(tm)\nlibrary(dplyr)\n\ndat <- NYTimes\n\n\nremove_commas <- sapply(t(dat), function(headline) strsplit(as.character(headline),  c(\",\")))\nwords_list <- sapply(remove_commas, function(phrase) lapply(phrase, function(word) strsplit(word, \" \")))\nwords <- unlist(words_list)\nnames(words) <- NULL\n# remove numbers\nnumbers <- grepl(\"[0-9]\", words)\nwords <- words[!numbers]\nwords <- tolower(words)\n# remove quotes\nwords <- strsplit(words, \"\\\"\")\nwords <- unlist(words)\nwords <- strsplit(words, \"\\'\")\nwords <- unlist(words)\n# remove newlines\nnewline <- grepl(\"\\\\n\", words)\nwords <- unlist(strsplit(words, \"\\\\n\"))\n# remove periods\nperiod <- grepl(\"\\\\.\", words)\nwords <- unlist(strsplit(words, \"\\\\.\"))\n# remove dash\ndash <- grepl(\"-\", words)\nwords <- unlist(strsplit(words, \"-\"))\n# remove parens\nlparens <- grepl(\"\\\\(\", words)\nwords <- unlist(strsplit(words, \"\\\\(\"))\nwords <- unlist(strsplit(words, \"\\\\)\"))\n# remove slash\nslash <- grepl(\"/\", words)\nwords <- unlist(strsplit(words, \"/\"))\n# remove semicolon\nsc <- grepl(\";\", words)\nwords <- unlist(strsplit(words, \";\"))\n# remove colon\ncol <- grepl(\":\", words)\nwords <- unlist(strsplit(words, \":\"))\n# remove single letter \"words\"\nwords <- words[nchar(words) > 1]\nwords <- words[!(words %in% stopwords(kind = \"en\"))]\n\ncommon_words <- names(sort(table(words), decreasing = T)[1:2000])\n\n\n\n\n\n\n\n### try superheat on GoogleNews with these common words #######\n\nload(\"/Users/rebeccabarter/Google Drive/Berkeley PhD/Research/Datasets/GoogleNews/GoogleNews.RData\")\nGoogleNews_common <- GoogleNews[tolower(GoogleNews[,1]) %in% common_words,]\n\nrownames(GoogleNews_common) <- GoogleNews_common[,1]\nGoogleNews_common <- GoogleNews_common[,-1]\n\n\n#### define cosine similarity ##############################\n\nmycosine <- function(x,y){\n  c <- sum(x*y) / (sqrt(sum(x*x)) * sqrt(sum(y*y)))\n  return(c)\n}\n\ncosinesim <- function(x) {\n  # initialize similarity matrix\n  m <- matrix(NA, nrow=ncol(x),ncol=ncol(x),dimnames=list(colnames(x),colnames(x)))\n  cos <- as.data.frame(m)\n  \n  for(i in 1:ncol(x)) {\n    print(i)\n    for(j in i:ncol(x)) {\n      co_rate_1 <- x[which(x[,i] & x[,j]),i]\n      co_rate_2 <- x[which(x[,i] & x[,j]),j]  \n      cos[i,j]= mycosine(co_rate_1,co_rate_2)\n      cos[j,i]=cos[i,j]        \n    }\n  }\n  return(cos)\n}\n\n\n\n###### calcualte cosine similarity for uppercase words only!\nuppercase_words <- rownames(GoogleNews_common) == toupper(rownames(GoogleNews_common))\nGoogleNews_uppercase <- GoogleNews_common[uppercase_words,]\n\n\nSPORTS <- rownames(GoogleNews_uppercase_cos)[order(GoogleNews_uppercase_cos[,\"SPORTS\"], decreasing = F)[1:500]]\nGoogleNews_uppercase[SPORTS, ]\n\n\n# calculate cosine DISSIMILARITY matrix\nif (!file.exists(\"/Users/rebeccabarter/Google Drive/Berkeley PhD/Research/Datasets/GoogleNews/GoogleNews_uppercase_cos.RData\")) {\n  GoogleNews_uppercase_cos <- 1 - cosinesim(t(GoogleNews_uppercase))\n  save(GoogleNews_uppercase_cos, file = \"/Users/rebeccabarter/Google Drive/Berkeley PhD/Research/Datasets/GoogleNews/GoogleNews_uppercase_cos.RData\")\n} else {\n  load(\"/Users/rebeccabarter/Google Drive/Berkeley PhD/Research/Datasets/GoogleNews/GoogleNews_uppercase_cos.RData\")\n}\n\n\n\n\n\n\n###### calcualte cosine similarity for uppercase words only!\nlowercase_words <- rownames(GoogleNews_common) == tolower(rownames(GoogleNews_common))\nGoogleNews_lowercase <- GoogleNews_common[lowercase_words,]\n\n\n\n# calculate cosine DISSIMILARITY matrix\nif (!file.exists(\"/Users/rebeccabarter/Google Drive/Berkeley PhD/Research/Datasets/GoogleNews/GoogleNews_lowercase_cos.RData\")) {\n  GoogleNews_lowercase_cos <- 1 - cosinesim(t(GoogleNews_lowercase))\n  save(GoogleNews_lowercase_cos, file = \"/Users/rebeccabarter/Google Drive/Berkeley PhD/Research/Datasets/GoogleNews/GoogleNews_lowercase_cos.RData\")\n} else {\n  load(\"/Users/rebeccabarter/Google Drive/Berkeley PhD/Research/Datasets/GoogleNews/GoogleNews_lowercase_cos.RData\")\n}\n\n\nSPORTS <- rownames(GoogleNews_uppercase_cos)[order(GoogleNews_uppercase_cos[,\"SPORTS\"], decreasing = F)[1:500]]\nGoogleNews_uppercase[SPORTS, SPORTS]\n\n\n",
    "created" : 1474998378154.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4174829521",
    "id" : "6EC7BE2D",
    "lastKnownWriteTime" : 1456799888,
    "last_content_update" : 1456799888,
    "path" : "~/Google Drive/Berkeley PhD/Research/Datasets/GoogleNews/GoogleNews_cosine.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 6,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}